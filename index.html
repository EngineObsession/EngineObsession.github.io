<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Engine Calculator Suite</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1022968838583578" crossorigin="anonymous"></script>
    <meta name="description" content="Free automotive engineering calculators. Calculate intake runner length, connecting rod length, compression ratio, piston speed, and fuel injector sizing. Includes specs for Honda, Ford, Chevy, and JDM engines.">
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Ultimate Engine Calculator Suite",
      "applicationCategory": "AutomotiveUtility",
      "operatingSystem": "Web",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
      "description": "Comprehensive automotive calculators for engine building, tuning, and drivetrain setup.",
      "featureList": "Intake Runner Calculator, Rod Length Calculator, Compression Ratio, Mean Piston Speed"
    }
    </script>

    <style>
        :root { --primary: #2563eb; --bg: #f8fafc; --card: #ffffff; --text: #1e293b; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; padding: 20px; max-width: 1000px; margin: 0 auto; }
        
        h1, h2, h3 { color: #0f172a; }
        
        /* Hero Section */
        .hero { text-align: center; margin-bottom: 40px; padding-bottom: 30px; border-bottom: 1px solid #e2e8f0; }
        .hero h1 { font-size: 2.5em; margin-bottom: 10px; }
        .hero p { color: #475569; max-width: 700px; margin: 0 auto; font-size: 1.1em; }

        /* Tab Navigation */
        .tab-nav { display: flex; border-bottom: 2px solid #e2e8f0; margin-bottom: 20px; overflow-x: auto; }
        .tab-btn { padding: 12px 24px; border: none; background: none; font-weight: 600; color: #64748b; cursor: pointer; border-bottom: 2px solid transparent; margin-bottom: -2px; transition: 0.2s; white-space: nowrap; }
        .tab-btn:hover { color: var(--primary); }
        .tab-btn.active { color: var(--primary); border-bottom-color: var(--primary); }
        
        /* Content Areas */
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        
        /* Calculator Cards */
        .card { background: var(--card); padding: 20px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; }
        .card h3 { margin-top: 0; color: var(--primary); font-size: 1.1em; border-bottom: 1px solid #f1f5f9; padding-bottom: 10px; }
        
        /* Form Elements */
        label { display: block; font-size: 0.85em; font-weight: 500; margin-top: 10px; color: #475569; }
        .input-group { display: flex; gap: 10px; }
        input, select { width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 4px; font-size: 0.95em; margin-top: 4px; box-sizing: border-box; }
        input:focus { border-color: var(--primary); outline: none; }
        
        /* Results */
        .result-box { margin-top: 15px; background: #f1f5f9; padding: 10px; border-radius: 4px; font-weight: bold; text-align: center; color: var(--primary); font-family: monospace; font-size: 1.1em; }
        .calc-btn { width: 100%; background: var(--primary); color: white; border: none; padding: 10px; border-radius: 4px; font-weight: 600; margin-top: 15px; cursor: pointer; transition: 0.2s; }
        .calc-btn:hover { background: #1d4ed8; }

        /* SEO Text Padding */
        .info-block { background: #eff6ff; border-left: 4px solid var(--primary); padding: 20px; margin-top: 20px; border-radius: 0 4px 4px 0; }
        .info-block h4 { margin: 0 0 10px 0; color: #1e3a8a; font-size: 1.1em; }
        .info-block p { margin: 0 0 10px 0; font-size: 0.95em; color: #334155; }
        .info-block ul { margin: 0; padding-left: 20px; font-size: 0.95em; color: #334155; }

        /* Global Selector */
        .global-controls { background: #1e293b; color: white; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        .global-controls h2 { margin: 0 0 10px 0; font-size: 1.2em; }
        .global-controls select { background: #334155; color: white; border: 1px solid #475569; }

        /* Footer List */
        #engine-list-seo { margin-top: 50px; border-top: 1px solid #e2e8f0; padding-top: 20px; }
        #seo-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 10px; padding: 0; list-style: none; }
        #seo-list li { font-size: 0.85em; color: #64748b; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="hero">
        <h1>Engine Building Calculator Suite</h1>
        <p>I'm just a car enthusiast who spends way too much time thinking about imaginary engine builds. I got tired of having 10 different tabs openâ€”one for a compression calculator, one for rod ratios, another for gearingâ€”so I decided to build a single place where I could do it all. I hope this helps you plan your next project, whether it's a real build or just a daydream. This page is automatically display data for popular platforms (Honda K-Series, GM LS, Toyota JZ, etc.) in the calculator fields so you can focus on what really matters: plugging in random numbers.</p>
    </div>

    <div class="global-controls">
        <h2>ðŸ”§ Project Setup</h2>
        <label style="color: #94a3b8;">Select a base engine to auto-fill all calculators:</label>
        <select id="globalEngine" onchange="autoFillAll()">
            <option value="">-- Choose Engine Preset --</option>
            </select>
    </div>

    <div class="tab-nav">
        <button class="tab-btn active" onclick="switchTab('tab-engine')">Engine Internals</button>
        <button class="tab-btn" onclick="switchTab('tab-airfuel')">Air & Fuel</button>
        <button class="tab-btn" onclick="switchTab('tab-reliability')">Reliability</button>
        <button class="tab-btn" onclick="switchTab('tab-drivetrain')">Drivetrain</button>
    </div>

    <div id="tab-engine" class="tab-content active">
        <div class="grid-container">
            <div class="card">
                <h3>Displacement Calculator</h3>
                <label>Bore (mm)</label><input type="number" id="disp_bore" placeholder="86.0">
                <label>Stroke (mm)</label><input type="number" id="disp_stroke" placeholder="86.0">
                <label>Cylinders</label><input type="number" id="disp_cyl" placeholder="4">
                <button class="calc-btn" onclick="calcDisplacement()">Calculate</button>
                <div class="result-box" id="res_disp">--- cc / --- L</div>
            </div>

            <div class="card">
                <h3>Connecting Rod Length</h3>
                <label>Deck Height (mm)</label><input type="number" id="rod_deck" placeholder="212.0">
                <label>Stroke (mm)</label><input type="number" id="rod_stroke" placeholder="86.0">
                <label>Piston Comp. Height (mm)</label><input type="number" id="rod_comp_height" placeholder="30.0">
                <label>Deck Clearance (mm) <small>(0 = flush)</small></label><input type="number" id="rod_clearance" placeholder="0.0">
                <button class="calc-btn" onclick="calcRodLength()">Calculate Length</button>
                <div class="result-box" id="res_rod_len">--- mm</div>
            </div>

            <div class="card">
                <h3>Static Compression Ratio</h3>
                <label>Cylinder Vol (cc)</label><input type="number" id="cr_cylvol" readonly style="background:#e2e8f0">
                <label>Combustion Chamber (cc)</label><input type="number" id="cr_chamber" placeholder="e.g. 45">
                <label>Piston Dome/Dish (cc)</label><input type="number" id="cr_dome" placeholder="-2 (Dish)">
                <label>Head Gasket Thickness (mm)</label><input type="number" id="cr_gasket" placeholder="0.6">
                <button class="calc-btn" onclick="calcCR()">Calculate CR</button>
                <div class="result-box" id="res_cr">--- : 1</div>
            </div>

            <div class="card">
                <h3>Rod / Stroke Ratio</h3>
                <label>Rod Length (mm)</label><input type="number" id="rs_rod" placeholder="139.0">
                <label>Stroke (mm)</label><input type="number" id="rs_stroke" placeholder="86.0">
                <button class="calc-btn" onclick="calcRSRatio()">Calculate</button>
                <div class="result-box" id="res_rs">Ratio: ---</div>
            </div>

             <div class="card">
                <h3>Bore / Stroke Ratio</h3>
                <label>Bore (mm)</label><input type="number" id="bs_bore" placeholder="86.0">
                <label>Stroke (mm)</label><input type="number" id="bs_stroke" placeholder="86.0">
                <button class="calc-btn" onclick="calcBSRatio()">Calculate</button>
                <div class="result-box" id="res_bs">Ratio: ---</div>
            </div>
        </div>

        <div class="info-block">
            <h4>Understanding Engine Geometry</h4>
             
            <p><strong>Calculating Rod Length (Stroker Kits):</strong> When increasing stroke, you are limited by the Block Deck Height. To fit a larger crank, you must often use a shorter connecting rod or a piston with a higher "Compression Height" (pin location). The formula used here is: <em>Deck Height - (Stroke Ã· 2) - Compression Height - Deck Clearance</em>.</p>
            <p><strong>Rod/Stroke Ratio:</strong> This ratio determines the angle of the rod during rotation. A higher ratio (above 1.75) reduces side-loading on cylinder walls, reducing friction and wear at high RPM. This is why high-revving engines like the Honda F20C (Ratio 1.82) last longer than "stroker" builds with poor ratios (below 1.50).</p>
        </div>
    </div>

    <div id="tab-airfuel" class="tab-content">
        <div class="grid-container">
            <div class="card">
                <h3>Intake Runner Tuner</h3>
                <label>Target RPM (Peak Power)</label><input type="number" id="run_rpm" placeholder="6000">
                <label>Cam Duration (Adv. Degrees)</label><input type="number" id="run_cam" placeholder="280">
                <button class="calc-btn" onclick="calcRunner()">Calculate Lengths</button>
                <div class="result-box" style="font-size: 0.8em; text-align: left;">
                    2nd Harmonic (Race): <span id="run_2" style="color:var(--primary)">---</span><br>
                    3rd Harmonic (Street): <span id="run_3" style="color:var(--primary)">---</span><br>
                    4th Harmonic (Torque): <span id="run_4" style="color:var(--primary)">---</span>
                </div>
            </div>

            <div class="card">
                <h3>Airflow (CFM)</h3>
                <label>Engine Size (Liters)</label><input type="number" id="cfm_liters">
                <label>Max RPM</label><input type="number" id="cfm_rpm" placeholder="7000">
                <label>Volumetric Eff. (%)</label><input type="number" id="cfm_ve" value="90">
                <button class="calc-btn" onclick="calcCFM()">Calculate CFM</button>
                <div class="result-box" id="res_cfm">--- CFM</div>
            </div>

            <div class="card">
                <h3>Fuel Injector Sizing</h3>
                <label>Target Horsepower (BHP)</label><input type="number" id="inj_hp" placeholder="300">
                <label>Number of Injectors</label><input type="number" id="inj_num" placeholder="4">
                <label>BSFC (0.5 NA / 0.65 Turbo)</label><input type="number" id="inj_bsfc" value="0.5">
                <label>Max Duty Cycle (%)</label><input type="number" id="inj_duty" value="80">
                <button class="calc-btn" onclick="calcInjectors()">Calculate</button>
                <div class="result-box" id="res_inj">--- cc/min</div>
            </div>
        </div>
        
        <div class="info-block">
            <h4>Intake & Fuel Tuning</h4>
             
            <p><strong>Intake Runner Harmonics:</strong> Intake runners use pressure waves to force air into the cylinder (supercharging effect). This happens when the pressure wave arrives at the intake valve exactly as it opens. 
            <br>&bull; <strong>2nd Harmonic:</strong> Strongest signal, usually for high-RPM drag racing.
            <br>&bull; <strong>3rd Harmonic:</strong> Best balance for Street/Strip (most factory performance manifolds).
            <br>&bull; <strong>4th Harmonic:</strong> Good for low-end torque and broader powerbands.</p>
        </div>
    </div>

    <div id="tab-reliability" class="tab-content">
        <div class="grid-container">
            <div class="card">
                <h3>Mean Piston Speed</h3>
                <label>Stroke (mm)</label><input type="number" id="mps_stroke">
                <label>Max RPM</label><input type="number" id="mps_rpm" placeholder="8000">
                <button class="calc-btn" onclick="calcPistonSpeed()">Calculate</button>
                <div class="result-box" id="res_mps">--- ft/min</div>
            </div>

            <div class="card">
                <h3>Dynamic Compression (DCR)</h3>
                <label>Static CR</label><input type="number" id="dcr_static" placeholder="11.0">
                <label>Rod Length (mm)</label><input type="number" id="dcr_rod">
                <label>Stroke (mm)</label><input type="number" id="dcr_stroke">
                <label>Intake Closing (ABDC)</label><input type="number" id="dcr_ivc" placeholder="45">
                <button class="calc-btn" onclick="calcDCR()">Calculate DCR</button>
                <div class="result-box" id="res_dcr">--- : 1</div>
            </div>
        </div>

        <div class="info-block">
            <h4>Engine Safety Limits</h4>
             
            <p><strong>Mean Piston Speed:</strong> This is the average speed of the piston as it travels up and down the bore. It is widely considered the primary limit for connecting rod strength.</p>
            <ul>
                <li><strong>Stock Cast Pistons:</strong> Generally safe up to ~4,000 ft/min.</li>
                <li><strong>Forged Pistons (4032/2618):</strong> Can withstand speeds over 5,000+ ft/min (F1 engines run much higher).</li>
            </ul>
        </div>
    </div>

    <div id="tab-drivetrain" class="tab-content">
        <div class="grid-container">
            <div class="card">
                <h3>Gear Ratio & Top Speed</h3>
                <label>Tire Diameter (inches)</label><input type="number" id="gear_tire" placeholder="24.5">
                <label>Final Drive Ratio</label><input type="number" id="gear_final" placeholder="4.10">
                <label>Gear Ratio</label><input type="number" id="gear_ratio" placeholder="0.85">
                <label>RPM</label><input type="number" id="gear_rpm" placeholder="7000">
                <button class="calc-btn" onclick="calcSpeed()">Calculate Speed</button>
                <div class="result-box" id="res_speed">--- mph</div>
            </div>

            <div class="card">
                <h3>Tire Size Compare</h3>
                <div class="input-group">
                    <input type="text" id="tire1" placeholder="205/55R16">
                    <input type="text" id="tire2" placeholder="225/45R17">
                </div>
                <button class="calc-btn" onclick="calcTireDiff()">Compare Diameters</button>
                <div class="result-box" id="res_tire">Diff: ---%</div>
            </div>
        </div>

        <div class="info-block">
            <h4>Drivetrain Optimization</h4>
            <p><strong>Gear Ratios:</strong> When swapping transmissions (e.g., putting a ZF 6-speed on an E30), the Final Drive Ratio is critical. A short ratio (4.10) accelerates faster but buzzes at high RPM on the highway. A tall ratio (2.93) is great for cruising/turbo load but feels sluggish off the line. Use this calculator to see your exact cruising RPM or theoretical top speed.</p>
        </div>
    </div>

    <section id="engine-list-seo">
        <h3>Available Engine Specifications</h3>
        <p>Database includes Deck Height, Bore, Stroke, and Cam Duration for the following engines:</p>
        <ul id="seo-list">
            </ul>
    </section>

<script>
    // --- 1. ENGINE DATABASE (Updated with Deck Height in mm & Cam Duration) ---
    const engineDatabase = {
    // ========================================================================
    // JDM: Honda, Toyota, Nissan, Mitsubishi, Subaru, Mazda
    // ========================================================================
    "Honda D16Z6 (Civic Si SOHC)": { bore: 75.0, stroke: 90.0, rod: 137.0, cyl: 4, cr: 9.2, deck: 212.0, cam: 236 },
    "Honda B16A (Civic Si/Type R)": { bore: 81.0, stroke: 77.4, rod: 134.0, cyl: 4, cr: 10.2, deck: 203.9, cam: 244 },
    "Honda B18C1 (Integra GSR)": { bore: 81.0, stroke: 87.2, rod: 137.9, cyl: 4, cr: 10.0, deck: 212.4, cam: 250 },
    "Honda B18C5 (Integra Type R)": { bore: 81.0, stroke: 87.2, rod: 137.9, cyl: 4, cr: 11.1, deck: 212.4, cam: 278 },
    "Honda H22A (Prelude VTEC)": { bore: 87.0, stroke: 90.7, rod: 143.0, cyl: 4, cr: 10.6, deck: 219.5, cam: 260 },
    "Honda K20A2 (RSX Type S)": { bore: 86.0, stroke: 86.0, rod: 139.0, cyl: 4, cr: 11.0, deck: 212.0, cam: 280 },
    "Honda K24A2 (TSX)": { bore: 87.0, stroke: 99.0, rod: 152.0, cyl: 4, cr: 10.5, deck: 231.5, cam: 260 },
    "Honda F20C (S2000 AP1)": { bore: 87.0, stroke: 84.0, rod: 153.0, cyl: 4, cr: 11.7, deck: 224.0, cam: 295 },
    "Honda F22C (S2000 AP2)": { bore: 87.0, stroke: 90.7, rod: 149.65, cyl: 4, cr: 11.1, deck: 224.0, cam: 280 },
    
    "Toyota 4AGE (Corolla AE86)": { bore: 81.0, stroke: 77.0, rod: 122.0, cyl: 4, cr: 9.4, deck: 190.0, cam: 240 },
    "Toyota 3S-GE (Altezza BEAMS)": { bore: 86.0, stroke: 86.0, rod: 138.0, cyl: 4, cr: 11.5, deck: 213.5, cam: 256 },
    "Toyota 1JZ-GTE (Chaser/Supra)": { bore: 86.0, stroke: 71.5, rod: 125.2, cyl: 6, cr: 8.5, deck: 203.0, cam: 224 },
    "Toyota 2JZ-GTE (Supra Mk4)": { bore: 86.0, stroke: 86.0, rod: 142.0, cyl: 6, cr: 8.5, deck: 219.0, cam: 233 },
    
    "Nissan CA18DET (S13)": { bore: 83.0, stroke: 83.6, rod: 133.0, cyl: 4, cr: 8.5, deck: 199.0, cam: 240 },
    "Nissan SR20DET (Silvia)": { bore: 86.0, stroke: 86.0, rod: 136.3, cyl: 4, cr: 8.5, deck: 211.3, cam: 240 },
    "Nissan RB25DET (Skyline)": { bore: 86.0, stroke: 71.7, rod: 121.5, cyl: 6, cr: 9.0, deck: 183.75, cam: 240 },
    "Nissan RB26DETT (GT-R)": { bore: 86.0, stroke: 73.7, rod: 121.5, cyl: 6, cr: 8.5, deck: 183.75, cam: 240 },
    "Nissan RB30 (Patrol Block)": { bore: 86.0, stroke: 85.0, rod: 152.5, cyl: 6, cr: 9.0, deck: 232.75, cam: 248 },
    "Nissan VQ35DE (350Z)": { bore: 95.5, stroke: 81.4, rod: 144.2, cyl: 6, cr: 10.3, deck: 215.0, cam: 246 },
    "Nissan VR38DETT (R35 GT-R)": { bore: 95.5, stroke: 88.4, rod: 165.0, cyl: 6, cr: 9.0, deck: 228.0, cam: 258 },
    
    "Mitsubishi 4G63T (Evo 8/9)": { bore: 85.0, stroke: 88.0, rod: 150.0, cyl: 4, cr: 8.8, deck: 229.0, cam: 252 },
    "Mitsubishi 4B11T (Evo X)": { bore: 86.0, stroke: 86.0, rod: 143.75, cyl: 4, cr: 9.0, deck: 213.5, cam: 256 },
    
    "Subaru EJ205 (WRX 2.0L)": { bore: 92.0, stroke: 75.0, rod: 130.5, cyl: 4, cr: 8.0, deck: 201.0, cam: 252 },
    "Subaru EJ257 (STI 2.5L)": { bore: 99.5, stroke: 79.0, rod: 130.5, cyl: 4, cr: 8.2, deck: 201.0, cam: 256 },
    "Subaru FA20 (BRZ/GT86)": { bore: 86.0, stroke: 86.0, rod: 129.3, cyl: 4, cr: 12.5, deck: 205.5, cam: 255 },
    
    "Mazda BP-4W (Miata 1.8 NB)": { bore: 83.0, stroke: 85.0, rod: 133.0, cyl: 4, cr: 9.5, deck: 207.9, cam: 238 },
    "Mazda MZR 2.3 DISI (Speed3)": { bore: 87.5, stroke: 94.0, rod: 150.5, cyl: 4, cr: 9.5, deck: 227.0, cam: 245 },

    // ========================================================================
    // USDM: Chevy, Ford, Dodge
    // ========================================================================
    "Chevy SBC 350 (Gen 1)": { bore: 101.6, stroke: 88.39, rod: 144.8, cyl: 8, cr: 9.0, deck: 229.2, cam: 260 },
    "Chevy LS1 (5.7L)": { bore: 99.0, stroke: 92.0, rod: 154.9, cyl: 8, cr: 10.1, deck: 234.7, cam: 265 },
    "Chevy LS3 (6.2L)": { bore: 103.25, stroke: 92.0, rod: 154.9, cyl: 8, cr: 10.7, deck: 234.7, cam: 270 },
    "Chevy LS7 (Z06 7.0L)": { bore: 104.8, stroke: 101.6, rod: 154.0, cyl: 8, cr: 11.0, deck: 234.7, cam: 290 },
    "Chevy LSA (ZL1/CTS-V)": { bore: 103.25, stroke: 92.0, rod: 154.9, cyl: 8, cr: 9.1, deck: 234.7, cam: 268 },
    
    "Ford 302 Windsor (5.0L)": { bore: 101.6, stroke: 76.2, rod: 129.3, cyl: 8, cr: 9.0, deck: 208.4, cam: 266 },
    "Ford 4.6L Modular (2V GT)": { bore: 90.2, stroke: 90.0, rod: 150.7, cyl: 8, cr: 9.4, deck: 227.0, cam: 256 },
    "Ford 4.6L Modular (4V Cobra)": { bore: 90.2, stroke: 90.0, rod: 150.7, cyl: 8, cr: 9.85, deck: 227.0, cam: 258 },
    "Ford 5.0L Coyote (Gen 1)": { bore: 92.2, stroke: 92.7, rod: 150.7, cyl: 8, cr: 11.0, deck: 227.0, cam: 260 },
    "Ford 5.2L Voodoo (GT350)": { bore: 94.0, stroke: 93.0, rod: 150.7, cyl: 8, cr: 12.0, deck: 227.0, cam: 270 },
    "Ford 7.3L Godzilla": { bore: 107.2, stroke: 101.0, rod: 160.5, cyl: 8, cr: 10.5, deck: 245.1, cam: 254 },
    "Ford 2.3L EcoBoost": { bore: 87.5, stroke: 94.0, rod: 149.3, cyl: 4, cr: 9.5, deck: 227.0, cam: 235 },
    "Ford Barra 4.0T (Falcon XR6)": { bore: 92.26, stroke: 99.31, rod: 152.0, cyl: 6, cr: 8.5, deck: 235.5, cam: 250 },
    
    "Dodge 5.7L Hemi": { bore: 99.5, stroke: 90.9, rod: 158.5, cyl: 8, cr: 9.6, deck: 234.9, cam: 260 },
    "Dodge 6.4L Apache (392)": { bore: 103.9, stroke: 94.6, rod: 158.5, cyl: 8, cr: 10.9, deck: 234.9, cam: 270 },
    "Dodge 6.2L Hellcat": { bore: 103.9, stroke: 90.9, rod: 158.5, cyl: 8, cr: 9.5, deck: 234.9, cam: 278 },
    "Dodge 8.4L Viper V10": { bore: 103.0, stroke: 100.6, rod: 158.5, cyl: 10, cr: 10.2, deck: 234.9, cam: 280 },

    // ========================================================================
    // Euro: BMW, VW/Audi, Porsche, Mercedes, Volvo
    // ========================================================================
    "BMW M20B25 (E30 325i)": { bore: 84.0, stroke: 75.0, rod: 135.0, cyl: 6, cr: 8.8, deck: 206.0, cam: 244 },
    "BMW M50B25 (E36 325i)": { bore: 84.0, stroke: 75.0, rod: 135.0, cyl: 6, cr: 10.0, deck: 210.0, cam: 240 },
    "BMW S54 (E46 M3)": { bore: 87.0, stroke: 91.0, rod: 139.0, cyl: 6, cr: 11.5, deck: 217.0, cam: 308 },
    "BMW N54 (335i Twin Turbo)": { bore: 84.0, stroke: 89.6, rod: 145.0, cyl: 6, cr: 10.2, deck: 221.0, cam: 245 },
    "BMW S65 (E92 M3 V8)": { bore: 92.0, stroke: 75.2, rod: 140.7, cyl: 8, cr: 12.0, deck: 217.5, cam: 290 },
    "BMW S85 (E60 M5 V10)": { bore: 92.0, stroke: 75.2, rod: 140.7, cyl: 10, cr: 12.0, deck: 217.5, cam: 290 },
    
    "VW/Audi 1.8T (20v)": { bore: 81.0, stroke: 86.4, rod: 144.0, cyl: 4, cr: 9.5, deck: 220.0, cam: 240 },
    "VW/Audi 2.0T TSI (EA888)": { bore: 82.5, stroke: 92.8, rod: 144.0, cyl: 4, cr: 9.6, deck: 220.0, cam: 250 },
    "VW/Audi VR6 2.8L (12v)": { bore: 81.0, stroke: 90.2, rod: 164.0, cyl: 6, cr: 10.0, deck: 247.0, cam: 258 },
    "Audi 2.5L TFSI (RS3)": { bore: 82.5, stroke: 92.8, rod: 144.0, cyl: 5, cr: 10.0, deck: 220.0, cam: 255 },
    "Audi 4.2L V8 (B7 RS4)": { bore: 84.5, stroke: 92.8, rod: 154.0, cyl: 8, cr: 12.5, deck: 228.0, cam: 280 },
    
    "Mercedes M156 (C63 AMG)": { bore: 102.2, stroke: 94.6, rod: 145.0, cyl: 8, cr: 11.3, deck: 228.0, cam: 280 },
    "Porsche 3.6L (964 Air Cooled)": { bore: 100.0, stroke: 76.4, rod: 127.0, cyl: 6, cr: 11.3, deck: 168.0, cam: 260 },
    "Porsche 4.0L Flat-6 (GT3)": { bore: 102.0, stroke: 81.5, rod: 130.0, cyl: 6, cr: 13.3, deck: 173.0, cam: 310 },
    "Volvo Redblock B230FT": { bore: 96.0, stroke: 80.0, rod: 152.0, cyl: 4, cr: 8.7, deck: 231.7, cam: 245 }
};

    // --- 2. INITIALIZATION & SEO GENERATION ---
    window.onload = function() {
        const select = document.getElementById("globalEngine");
        const seoList = document.getElementById("seo-list");

        for (const [key, val] of Object.entries(engineDatabase)) {
            // Populate Dropdown
            let option = document.createElement("option");
            option.value = key;
            option.text = key;
            select.appendChild(option);

            // Populate SEO List (Visible to Google)
            let li = document.createElement("li");
            li.innerHTML = `<strong>${key}</strong>: ${val.bore}mm Bore, ${val.stroke}mm Stroke, ${val.deck}mm Deck.`;
            seoList.appendChild(li);
        }
    };

    // --- 3. UI LOGIC ---
    function switchTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function autoFillAll() {
        const engine = engineDatabase[document.getElementById("globalEngine").value];
        if (!engine) return;

        // Auto-fill Basic Inputs
        setVal("disp_bore", engine.bore); setVal("disp_stroke", engine.stroke); setVal("disp_cyl", engine.cyl);
        setVal("bs_bore", engine.bore); setVal("bs_stroke", engine.stroke);
        setVal("rs_rod", engine.rod); setVal("rs_stroke", engine.stroke);
        setVal("mps_stroke", engine.stroke);
        setVal("dcr_rod", engine.rod); setVal("dcr_stroke", engine.stroke); setVal("dcr_static", engine.cr);

        // Auto-fill Rod Calc Inputs
        setVal("rod_deck", engine.deck);
        setVal("rod_stroke", engine.stroke);
        const compHeight = engine.deck - engine.rod - (engine.stroke / 2);
        setVal("rod_comp_height", compHeight.toFixed(2));
        setVal("rod_clearance", 0); 

        // Auto-fill Runner Calc
        setVal("run_cam", engine.cam);

        // Run basic calc
        calcDisplacement(); 
    }

    // --- 4. CALCULATOR MATH ---
    function calcRunner() {
        const rpm = getVal("run_rpm");
        const cam = getVal("run_cam"); // Advertised Duration
        if(rpm && cam) {
            // Formula: L = ((720 - Cam) * 0.25 * 1125 * 12) / RPM
            // V = 1125 ft/s (Speed of sound approx)
            // Constant = 1125 * 12 * 0.25 = 3375
            // Base Pulse Distance = (720 - cam) * 3375 / RPM
            
            const base = ((720 - cam) * 3375) / rpm;
            
            // Harmonics
            const h2 = base; // 2nd Harmonic (Strongest)
            const h3 = base * (2/3); // 3rd Harmonic
            const h4 = base * 0.5; // 4th Harmonic

            document.getElementById("run_2").innerText = h2.toFixed(1) + '"';
            document.getElementById("run_3").innerText = h3.toFixed(1) + '"';
            document.getElementById("run_4").innerText = h4.toFixed(1) + '"';
        }
    }

    function calcDisplacement() {
        const b = getVal("disp_bore"), s = getVal("disp_stroke"), c = getVal("disp_cyl");
        if(b && s && c) {
            const cc = (Math.PI * Math.pow(b/2, 2) * s * c) / 1000;
            document.getElementById("res_disp").innerText = `${cc.toFixed(0)} cc / ${(cc/1000).toFixed(1)} L`;
            document.getElementById("cr_cylvol").value = ((Math.PI * Math.pow(b/2, 2) * s) / 1000).toFixed(2);
            document.getElementById("cfm_liters").value = (cc/1000).toFixed(1);
        }
    }

    function calcRodLength() {
        const deck = getVal("rod_deck"), stroke = getVal("rod_stroke"), compH = getVal("rod_comp_height"), clear = getVal("rod_clearance") || 0;
        if (deck && stroke && compH) {
            const rod = deck - (stroke / 2) - compH - clear;
            document.getElementById("res_rod_len").innerText = `${rod.toFixed(2)} mm`;
        }
    }

    function calcCR() {
        const cyl = getVal("cr_cylvol"), chamber = getVal("cr_chamber"), dome = getVal("cr_dome") || 0;
        if (cyl && chamber) {
            const cr = (cyl + chamber + dome) / (chamber + dome);
            document.getElementById("res_cr").innerText = `${cr.toFixed(1)} : 1`;
        }
    }

    function calcRSRatio() {
        const r = getVal("rs_rod"), s = getVal("rs_stroke");
        if(r && s) document.getElementById("res_rs").innerText = `Ratio: ${(r/s).toFixed(2)}`;
    }

    function calcBSRatio() {
        const b = getVal("bs_bore"), s = getVal("bs_stroke");
        if(b && s) {
            const r = b/s;
            document.getElementById("res_bs").innerText = `${r.toFixed(2)} (${r>1 ? 'Over-Square' : 'Under-Square'})`;
        }
    }

    function calcCFM() {
        const l = getVal("cfm_liters"), rpm = getVal("cfm_rpm"), ve = getVal("cfm_ve");
        if(l && rpm && ve) {
            const cid = l * 61.0237;
            const cfm = (cid * rpm * (ve/100)) / 3456;
            document.getElementById("res_cfm").innerText = `${cfm.toFixed(0)} CFM`;
        }
    }

    function calcInjectors() {
        const hp = getVal("inj_hp"), num = getVal("inj_num"), bsfc = getVal("inj_bsfc"), duty = getVal("inj_duty");
        if(hp && num) {
            const lbsHr = (hp * bsfc) / (num * (duty/100));
            document.getElementById("res_inj").innerText = `${(lbsHr * 10.5).toFixed(0)} cc/min`;
        }
    }

    function calcPistonSpeed() {
        const s = getVal("mps_stroke"), rpm = getVal("mps_rpm");
        if(s && rpm) {
            const fpm = ((s / 25.4) * rpm) / 6;
            document.getElementById("res_mps").innerText = `${fpm.toFixed(0)} ft/min`;
        }
    }

    function calcDCR() {
        const stat = getVal("dcr_static"), ivc = getVal("dcr_ivc");
        if(stat && ivc) {
            const factor = 1 - (ivc/180)*0.5; 
            document.getElementById("res_dcr").innerText = `Est. ${ (stat * factor).toFixed(1) } : 1`; 
        }
    }

    function calcSpeed() {
        const tire = getVal("gear_tire"), final = getVal("gear_final"), ratio = getVal("gear_ratio"), rpm = getVal("gear_rpm");
        if(tire && final && ratio && rpm) {
            const mph = (rpm * tire) / (final * ratio * 336);
            document.getElementById("res_speed").innerText = `${mph.toFixed(1)} mph`;
        }
    }

    function calcTireDiff() {
        const p1 = parseTire(document.getElementById("tire1").value);
        const p2 = parseTire(document.getElementById("tire2").value);
        if(p1 && p2) {
            const diff = ((p2 - p1) / p1) * 100;
            document.getElementById("res_tire").innerText = `Diff: ${diff > 0 ? '+' : ''}${diff.toFixed(2)}%`;
        } else {
             document.getElementById("res_tire").innerText = "Invalid Format";
        }
    }

    function getVal(id) { return parseFloat(document.getElementById(id).value); }
    function setVal(id, val) { document.getElementById(id).value = val; }
    function parseTire(str) {
        const p = str.match(/(\d{3})[\/](\d{2})[R\/z]?(\d{2})/i);
        if(p) return (parseFloat(p[1]) * (parseFloat(p[2])/100) * 2 / 25.4) + parseFloat(p[3]);
        return null;
    }
</script>
</body>
</html>
